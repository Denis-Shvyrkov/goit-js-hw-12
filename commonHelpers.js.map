{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function searchImages(searchTerm, page, perPage) {\n  axios.defaults.baseURL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n  const KEY = '42535847-effe6d5cdde3e67806355c12e&q';\n  const IMG_TYPE = 'photo';\n  const ORIENTATION = 'horizontal';\n  const PARAMS = `?key=${KEY}&q=${searchTerm}&image_type=${IMG_TYPE}&orientation=${ORIENTATION}&safesearch=true&page=${page}&per_page=${perPage}`;\n  const resp = await axios.get(END_POINT + PARAMS);\n  return resp;\n}\n","export function galleryMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        comments,\n        views,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\"><a href=\"${largeImageURL}\">\n  <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" >\n  \n  <div class=\"img-details\">\n  <div class=\"img-details-item\">\n  <p>Likes</p>\n  <p>${likes}</p>\n  </div>\n  <div class=\"img-details-item\">\n  <p>Views</p>\n  <p>${views}</p>\n  </div>\n  <div class=\"img-details-item\">\n  <p>Comments</p>\n  <p>${comments}</p>\n  </div>\n  <div class=\"img-details-item\">\n  <p>Downloads</p>\n  <p>${downloads}</p>\n  </div>\n  </div>\n  </a>\n  </li>`;\n      }\n    )\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { searchImages } from './js/pixabay-api';\nimport { galleryMarkup } from './js/render-functions';\n\nconst refs = {\n  formEl: document.querySelector('.search-form'),\n  imgGallery: document.querySelector('.gallery'),\n  submitBtn: document.querySelector('.submit'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader-container'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n  galleryItem: document.querySelector('.gallery-item'),\n};\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst iziToastOptions = {\n  theme: 'light',\n  backgroundColor: '#B51B1B',\n  messageColor: '#FFFFFF',\n  position: 'topRight',\n  iconColor: '#FFFFFF',\n  color: '#FFFFFF',\n};\n\nlet page = 1;\nconst perPage = 15;\n\nlet query;\n\nlightbox.on('show.simplelightbox');\n\nrefs.formEl.addEventListener('submit', onSubmitBtn);\nrefs.loadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nfunction renderGallery(images) {\n  const markup = galleryMarkup(images);\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nasync function onSubmitBtn(e) {\n  e.preventDefault();\n  page = 1;\n  removeHidden(refs.loader);\n  refs.gallery.innerHTML = '';\n  setHidden(refs.loadMoreBtn);\n\n  query = e.target.elements.search.value.trim();\n\n  if (query === '') {\n    setHidden(refs.loader);\n    iziToast.error({\n      ...iziToastOptions,\n      message: 'Please, enter a request!',\n    });\n    return;\n  }\n\n  try {\n    const searchResponse = await searchImages(query, page, perPage);\n    const searchArray = searchResponse.data.hits;\n\n    console.log(searchResponse);\n    if (searchArray.length === 0) {\n      setHidden(refs.loader);\n      iziToast.error({\n        ...iziToastOptions,\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n    if (searchArray.length >= 15) {\n      removeHidden(refs.loadMoreBtn);\n    }\n\n    renderGallery(searchArray);\n\n    setHidden(refs.loader);\n  } catch (e) {\n    console.log(e);\n  }\n  e.target.reset();\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n\n  removeHidden(refs.loader);\n\n  setHidden(refs.loadMoreBtn);\n\n  if (query === '') {\n    setHidden(refs.loader);\n    iziToast.error({\n      ...iziToastOptions,\n      message: 'Please, enter a request!',\n    });\n    return;\n  }\n\n  try {\n    const searchResponse = await searchImages(query, page, perPage);\n    const searchArray = searchResponse.data.hits;\n    const totalHits = searchResponse.data.totalHits;\n    if (totalHits === 0) {\n      setHidden(refs.loader);\n\n      iziToast.error({\n        ...iziToastOptions,\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    if (totalHits === document.querySelectorAll('.gallery-item').length) {\n      setHidden(refs.loadMoreBtn);\n      setHidden(refs.loader);\n      iziToast.show({\n        ...iziToastOptions,\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      renderGallery(searchArray);\n      setHidden(refs.loader);\n      removeHidden(refs.loadMoreBtn);\n      const rect = document\n        .querySelector('.gallery-item')\n        .getBoundingClientRect();\n\n      window.scrollBy({\n        top: rect.height * 2,\n        behavior: 'smooth',\n      });\n\n      console.log(rect);\n    }\n  } catch (e) {\n    console.log(e);\n  }\n}\nfunction setHidden(el) {\n  el.classList.add('hidden');\n}\n\nfunction removeHidden(el) {\n  el.classList.remove('hidden');\n}\n"],"names":["searchImages","searchTerm","page","perPage","axios","END_POINT","PARAMS","galleryMarkup","images","webformatURL","largeImageURL","tags","likes","comments","views","downloads","refs","lightbox","SimpleLightbox","iziToastOptions","query","onSubmitBtn","onLoadMoreClick","renderGallery","markup","removeHidden","setHidden","iziToast","searchResponse","searchArray","e","totalHits","rect","el"],"mappings":"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"}